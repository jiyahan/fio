<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>fio</title>
    <style type="text/css">
      body {
        background-color: #6080a0;
        color: #ffffff;
      }
      h1 {
        text-align: center;
        font-size: 1.5em;
        font-weight: bold;
      }
      h2 {
        text-align: center;
        font-size: 1.4em;
        font-weight: bold;
      }
      p {
        text-align: justify;
      }
      .main {
        margin-left: auto;
        margin-right: auto;
        padding: .5ex 1ex .5ex 1ex;
        background-color: #e0e0e0;
        color: #000000;
        display: table;
      }
      .sections {
        margin-top: 0;
        padding-left: 2em;
      }
      .main > .sections {
        /* This is the header section for the whole module */
        margin-left: auto;
        margin-right: auto;
        margin-top: 0;
        padding: 1ex 1em 1ex 1em;
        background-color: #f0f0f0;
	color: #000000;
      }
      .decl, .desc {
        padding: .5ex 1ex .5ex 1ex;
        margin: 1ex 0 1ex 0;
      }
      .sections, dt.decl > p {
	/* We wrap dt.decl in a <p> so that the <dt> is allowed to expand to
	the width of the <dd>, otherwise the background will be truncated. Yes
	this is ugly but CSS is a bit crippled. */
        max-width: 45em;
      }
      dt.decl, dt.decl > p {
        margin-top: 0;
        margin-bottom: 0;
        text-align: left;
        font-size: 1.5em;
        font-weight: bold;
      }
      dd.decl {
        margin-top: 0;
      }
      .sections p:first-child, h4.sec + p {
        margin-top: 0;
      }
      .decl {
        background-color: #f0f0f0;
        color: #000000;
      }
      .decl .decl {
        background-color: #f8f8f8;
	color: #000000;
      }
      .decl .decl .decl {
        background-color: #ffffff;
        color: #000000;
      }
      dd dl {
        margin-left: 2em;
      }
      h3.memb {
        text-align: left;
        padding-left: 2em;
        font-size: 1em;
        font-weight: bold;
      }
      pre.d_code {
        padding: .5ex 1ex .5ex 1ex;
        border: 1px dotted black;
        background-color: #ffffc0;
	color: #000000;
      }
      h4.sec {
        margin-top: 0;
        margin-bottom: 0;
        text-align: left;
        font-size: 1em;
        font-weight: bold;
      }
      dl.params {
        margin-top: 0;
      }
      .paramname {
        margin-top: 0;
        margin-bottom: 0;
        padding-right: 1em;
        vertical-align: top;
        font-size: 1.1em;
        white-space: nowrap;
      }
    </style>
    
  </head>
  <body>
  
  <div class="main">
    
    <h1>Module: fio</h1>
    <!-- Generated by Ddoc from source/fio/fio.d -->
</p><p>
<div class="modmemb">
    <h2>Details</h2>
    <dl><dt class="decl"><p><code><a name="stacksize"></a>@property int <u>stacksize</u>();
</code></p></dt>
<dd class="decl desc"><div class="sections"><p>Get stack size for new fibers. Default value is 64k.
</p>
</div>
</dd>
<dt class="decl"><p><code><a name="stacksize.2"></a>@property void <u>stacksize</u>(int <code><i>s</i></code>);
</code></p></dt>
<dd class="decl desc"><div class="sections"><p>Set stack size for new fibers
</p>
</div>
</dd>
<dt class="decl"><p><code><a name="Daemon"></a>class <u>Daemon</u>(F, A...);
</code></p></dt>
<dd class="decl desc"><div class="sections"><p>Excecution unit that run in "background". You can't wait for its completion or get result.
</p>
<p>To run asyncronous code that will return any result use Future</p>
</div>
<h3 class="memb">Members:</h3>
  <dl><dt class="decl"><p><code><a name="Daemon.this"></a>pure @safe this(F <code><i>f</i></code>, A <code><i>a</i></code>);
</code></p></dt>
<dd class="decl desc"><div class="sections"><p>Constructor
</p>
<h4 class="sec">Parameters:</h4>
  <table class="params"><tr><td class="paramname"><code>F <code><i>f</i></code></code></td>
<td class="paramdesc"><p>function or generator</p></td></tr>
<tr><td class="paramname"><code>A <code><i>a</i></code></code></td>
<td class="paramdesc"><p>args to call <code><i>f</i></code></p></td></tr>
</table>
</div>
</dd>
<dt class="decl"><p><code><a name="Daemon.start"></a>auto <u>start</u>();
</code></p></dt>
<dd class="decl desc"><div class="sections"><p>You have to call <u>start</u>() method to <u>start</u> daemon running
</p>
<h4 class="sec">Parameters:</h4>
  <table class="params"></table>
<p><h4 class="sec">Return:</h4>
Daemon object (you can chain calls)</p>
</div>
</dd>
</dl>
</dd>
<dt class="decl"><p><code><a name="Future"></a>class <u>Future</u>(F, A...);
</code></p></dt>
<dd class="decl desc"><div class="sections"><p>Execution unit that run in "foreground" - you can wait for completion and get results
</p>
</div>
<h3 class="memb">Members:</h3>
  <dl><dt class="decl"><p><code><a name="Future.this"></a>pure nothrow @nogc @safe this(F <code><i>f</i></code>, A <code><i>a</i></code>);
</code></p></dt>
<dd class="decl desc"><div class="sections"><p>Constructor
</p>
<h4 class="sec">Parameters:</h4>
  <table class="params"><tr><td class="paramname"><code>F <code><i>f</i></code></code></td>
<td class="paramdesc"><p>function or generator</p></td></tr>
<tr><td class="paramname"><code>A <code><i>a</i></code></code></td>
<td class="paramdesc"><p>args to call <code><i>f</i></code></p></td></tr>
</table>
</div>
</dd>
<dt class="decl"><p><code><a name="Future.start"></a>@safe auto <u>start</u>();
</code></p></dt>
<dd class="decl desc"><div class="sections"><p>You have to call <u>start</u>() to <u>start</u> Future execution
</p>
</div>
</dd>
<dt class="decl"><p><code><a name="Future.get"></a>@property @safe auto <u>get</u>();
</code></p></dt>
<dd class="decl desc"><div class="sections"><p>Get return value of f when f completes.
</p>
</div>
</dd>
<dt class="decl"><p><code><a name="Future.ready"></a>@property @safe bool <u>ready</u>();
</code></p></dt>
<dd class="decl desc"><div class="sections"><p>Get completion status and result readiness
</p>
<p><h4 class="sec">Return:</h4>
True if task were started and were finished</p>
</div>
</dd>
<dt class="decl"><p><code><a name="Future.wait"></a>int <u>wait</u>(Duration <code><i>d</i></code> = 0.seconds);
</code></p></dt>
<dd class="decl desc"><div class="sections"><p>Wait for task completion. Also start task if you forget to call method start()
</p>
<h4 class="sec">Parameters:</h4>
  <table class="params"><tr><td class="paramname"><code>Duration <code><i>d</i></code></code></td>
<td class="paramdesc"><p>how long to <u>wait</u> (forewer by default)</p></td></tr>
</table>
<p><h4 class="sec">Return:</h4>
status of <u>wait</u> (SUCCESS or TIMEDOUT)</p>
</div>
</dd>
<dt class="decl"><p><code><a name="Future.waitAndGet"></a>@property auto <u>waitAndGet</u>(Duration <code><i>d</i></code> = 0.seconds);
</code></p></dt>
<dd class="decl desc"><div class="sections"><p>Wait for task completion and return result. Also start task if you forget to call method start()
</p>
<h4 class="sec">Parameters:</h4>
  <table class="params"><tr><td class="paramname"><code>Duration <code><i>d</i></code></code></td>
<td class="paramdesc"><p>how long to wait (forewer by default)</p></td></tr>
</table>
<p><h4 class="sec">Return:</h4>
result of f, or exceptioin ResultNotReady if result is not ready after timeout <code><i>d</i></code> expired.</p>
</div>
</dd>
</dl>
</dd>
<dt class="decl"><p><code><a name="makeFuture"></a>pure nothrow @safe auto <u>makeFuture</u>(F, A...)(F <code><i>f</i></code>, A <code><i>a</i></code>);
</code></p></dt>
<dd class="decl desc"><div class="sections"><p><u>makeFuture</u> create "Future" - execution unit that you
</p>
<p>can start, wait for completion and get result

</p>
<h4 class="sec">Parameters:</h4>
  <table class="params"><tr><td class="paramname"><code>F f</code></td>
<td class="paramdesc"><p>function or delegate to run</p></td></tr>
<tr><td class="paramname"><code>A a</code></td>
<td class="paramdesc"><p>args for calling f</p></td></tr>
</table>
<h4 class="sec">Examples:</h4> <p><pre class="d_code">
globalLogLevel(LogLevel.info);
info(<span style="color:red">"Test Future"</span>);
<span style="color:blue">new</span> fioTask((){
    <span style="color:blue">int</span> base = 1;
    <span style="color:blue">void</span> f0() {
    }
    <span style="color:blue">int</span> f1(<span style="color:blue">int</span> a) {
        <span style="color:blue">return</span> a;
    }
    <span style="color:blue">int</span> f2(<span style="color:blue">int</span> a, <span style="color:blue">int</span> b) {
        infof(<span style="color:red">"f2 sleep, wait %d seconds, please."</span>, a);
        fioSleep(dur!<span style="color:red">"seconds"</span>(a));
        <span style="color:blue">return</span> b+base;
    }
    <span style="color:blue">auto</span> t0 = <u>makeFuture</u>(&amp;f0).start();
    <span style="color:blue">auto</span> t1 = <u>makeFuture</u>(&amp;f1, 1).start();
    <span style="color:blue">auto</span> t2 = <u>makeFuture</u>(&amp;f2, 5, 1).start();
    <span style="color:blue">auto</span> t3 = <u>makeFuture</u>((string s) {
            <span style="color:blue">assert</span>(s == <span style="color:red">"hello"</span>);
        }, <span style="color:red">"hello"</span>).start();
    <span style="color:blue">auto</span> t = tuple(t0, t1, t2, t3);
    <span style="color:blue">assert</span>(t.waitAll(1.seconds) == [0,0,TIMEOUT,0]);
    info(<span style="color:red">"Future waitAll - ok"</span>);
    <span style="color:blue">auto</span> tasks = map!(a =&gt; <u>makeFuture</u>(&amp;f1, a).start)([1, 2, 3]).array();
    tasks ~= <u>makeFuture</u>(&amp;f1, 4).start;
    <span style="color:green">//fioSleep(1.seconds);
</span>    <span style="color:blue">assert</span>(tasks.map!(a =&gt; a.waitAndGet).array() == [1,2,3,4]);
    info(<span style="color:red">"Future waitAndGet - ok"</span>);
    <span style="color:blue">auto</span> d = makeDaemon(
            (<span style="color:blue">int</span> a) {
                infof(<span style="color:red">"Daemon got %d and return"</span>, a);
            }, 1
        ).start();
    stopEventLoop();
});
runEventLoop();
info(<span style="color:red">"Test Future! Done"</span>);
</pre>
</p></div>
</dd>
<dt class="decl"><p><code><a name="makeDaemon"></a>pure nothrow @safe auto <u>makeDaemon</u>(F, A...)(F <code><i>f</i></code>, A <code><i>a</i></code>);
</code></p></dt>
<dd class="decl desc"><div class="sections"><p><u>makeDaemon</u> create "Daemon" - execution unit that you
</p>
<p>can start but can't wait for completion or get result.
</p><p>

All you can do with daemons - wait when all daemons finish with call
</p><p>

waitForAllDaemons()

</p>
<h4 class="sec">Parameters:</h4>
  <table class="params"><tr><td class="paramname"><code>F f</code></td>
<td class="paramdesc"><p>function or delegate to run</p></td></tr>
<tr><td class="paramname"><code>A a</code></td>
<td class="paramdesc"><p>args for calling f</p></td></tr>
</table>
</div>
</dd>
<dt class="decl"><p><code><a name="makeApp"></a>auto <u>makeApp</u>(F, A...)(F <code><i>f</i></code>, A <code><i>a</i></code>);
</code></p></dt>
<dd class="decl desc"><div class="sections"><p><u>makeApp</u> create "Future" that
 will stop eventLoop when completed
</p>
<h4 class="sec">Parameters:</h4>
  <table class="params"><tr><td class="paramname"><code>F f</code></td>
<td class="paramdesc"><p>function or delegate to run</p></td></tr>
<tr><td class="paramname"><code>A a</code></td>
<td class="paramdesc"><p>args for calling f</p></td></tr>
</table>
<p><h4 class="sec">Return:</h4>
Nothing</p>
<h4 class="sec">Examples:</h4> <p><pre class="d_code">
globalLogLevel(LogLevel.info);
info(<span style="color:red">"Test makeApp"</span>);
<u>makeApp</u>((){
    <span style="color:blue">void</span> f0() {
        <span style="color:blue">auto</span> aa = [1:1];
    }
    <span style="color:blue">auto</span> t0 = makeFuture(&amp;f0).start();
    t0.wait();
});
runEventLoop();
info(<span style="color:red">"App finished"</span>);
</pre>
</p></div>
</dd>
<dt class="decl"><p><code><a name="waitForAllDaemons"></a>int <u>waitForAllDaemons</u>(Duration <code><i>timeout</i></code> = 0.seconds);
</code></p></dt>
<dd class="decl desc"><div class="sections"><p>wait(polling used) until all started daemon tasks finish
</p>
<h4 class="sec">Parameters:</h4>
  <table class="params"><tr><td class="paramname"><code>Duration <code><i>timeout</i></code></code></td>
<td class="paramdesc"><p>,how long to wait</p></td></tr>
</table>
<p><h4 class="sec">Return:</h4>
TIMEOUT or 0</p>
</div>
</dd>
<dt class="decl"><p><code><a name="waitAll"></a>int[] <u>waitAll</u>(W)(W <code><i>tasks</i></code>, Duration <code><i>d</i></code> = 0.seconds);
</code></p></dt>
<dd class="decl desc"><div class="sections"><p>Wait until all tasks in array finish
</p>
<h4 class="sec">Parameters:</h4>
  <table class="params"><tr><td class="paramname"><code>W tasks</code></td>
<td class="paramdesc"><p>range of objects, supporting wait()</p></td></tr>
<tr><td class="paramname"><code>Duration d</code></td>
<td class="paramdesc"><p>time to wait</p></td></tr>
</table>
<p><h4 class="sec">Return:</h4>
array of the 0(success) and TIMEOUT(failed to wait)</p>
</div>
</dd>
<dt class="decl"><p><code><a name="fioSleep"></a>void <u>fioSleep</u>(in Duration <code><i>d</i></code>);
</code></p></dt>
<dd class="decl desc"><div class="sections"><p>sleep for some duration.
</p>
<p>you have to use this sleep as it allow concurrency

</p>
<h4 class="sec">Parameters:</h4>
  <table class="params"><tr><td class="paramname"><code>Duration <code><i>d</i></code></code></td>
<td class="paramdesc"><p>duration</p></td></tr>
</table>
<p><h4 class="sec">Return:</h4>
void

</p>
<h4 class="sec">Examples:</h4> <p><pre style="display:inline;" class="d_inline_code"><u>fioSleep</u>(1.seconds)</pre></p>
</div>
</dd>
<dt class="decl"><p><code><a name="makeTCPListener"></a>auto <u>makeTCPListener</u>(F)(string <code><i>host</i></code>, ushort <code><i>port</i></code>, F <code><i>f</i></code>);
</code></p></dt>
<dd class="decl desc"><div class="sections"><p>Create TCPListener
</p>
<h4 class="sec">Parameters:</h4>
  <table class="params"><tr><td class="paramname"><code>string host</code></td>
<td class="paramdesc"><p>interface to listen</p></td></tr>
<tr><td class="paramname"><code>ushort port</code></td>
<td class="paramdesc"><p>port to listen</p></td></tr>
<tr><td class="paramname"><code>F f</code></td>
<td class="paramdesc"><p>function or delegate to execute on each connectiom</p></td></tr>
</table>
<p><h4 class="sec">Return:</h4>
instance of class fioTCPListener</p>
</div>
</dd>
</dl>
  </div>

  </div>
  
  </body>
</html>
